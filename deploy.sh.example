#!/bin/bash

# Pi_Eyes Core Deployment Script (Example Template)
# Copy this to deploy.sh and update with your Pi's IP address and password
#
# This script deploys the core Pi_Eyes system (eyes.py)
# For service-specific deployment, use the deploy scripts in services/ directories

PI_HOST="sshpi@192.168.1.100"  # Update with your Pi's IP
PI_PASSWORD="your-password-here"  # Update with your Pi's password
PI_DEST="/boot/Pi_Eyes"

echo "=========================================="
echo "Pi_Eyes Core Deployment"
echo "=========================================="
echo "Deploying to: $PI_HOST"
echo "Destination: $PI_DEST"
echo ""

# Copy core Python files
echo "Copying eyes.py..."
sshpass -p "$PI_PASSWORD" scp ./eyes.py "$PI_HOST:eyes.py"

# Install and configure on Pi
echo ""
echo "Installing on Raspberry Pi..."
sshpass -p "$PI_PASSWORD" ssh "$PI_HOST" << EOF
    # Move files to destination
    echo "Moving eyes.py to $PI_DEST..."
    sudo mv /home/sshpi/eyes.py $PI_DEST/eyes.py
    sudo chmod +x $PI_DEST/eyes.py

    echo ""
    echo "Files deployed successfully!"
EOF

echo ""
echo "=========================================="
echo "Deployment Complete!"
echo "=========================================="
echo ""
echo "The Pi will reboot in 10 seconds to apply changes."
echo "Press Ctrl+C to cancel the reboot."
echo ""

# Countdown before reboot
for i in {10..1}; do
    echo -ne "Rebooting in $i seconds...\r"
    sleep 1
done

echo ""
echo "Rebooting Pi..."
sshpass -p "$PI_PASSWORD" ssh "$PI_HOST" "sudo reboot now"

echo ""
echo "Reboot initiated. Wait ~30 seconds for Pi to restart."
